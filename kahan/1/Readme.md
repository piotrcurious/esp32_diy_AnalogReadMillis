A bit improved version using Kahan summation
